<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SystÃ¨me de gestion des livrets scolaires pour le Programme d'Ã©ducation intermÃ©diaire (PEI) et le Programme du diplÃ´me (DP) de l'IB">
    <meta name="keywords" content="livret scolaire, IB, PEI, DP, Ã©ducation, contributions">
    <title>Livret scolaire IB</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <h1>Livret scolaire</h1>
        <div class="header-buttons">
            <button id="generateWordButton" onclick="generateAllWordsInSection()" title="GÃ©nÃ©rer un ZIP contenant tous les livrets Word de la classe">ğŸ“¦ GÃ©nÃ©rer ZIP Classe (Tous les Livrets)</button>
            <button id="generateExcelButton" onclick="generateExcel()" style="background-color: #198754;" title="GÃ©nÃ©rer un export Excel">GÃ©nÃ©rer Excel (Section)</button>
        </div>
        <div class="progress-container" id="progressContainer">
            <div class="progress-bar" id="progressBar">
                <span class="progress-text" id="progressText">0%</span>
            </div>
        </div>
    </header>

    <main>
        <div class="select-container">
            <section id="step0">
                <h2>1. Choisir une Section</h2>
                <div class="section-buttons">
                    <button class="garÃ§ons" onclick="handleSectionChange('garÃ§ons')">
                        <span>ğŸ‘¨â€ğŸ“</span> Section des GarÃ§ons
                        <small style="display:block;font-size:0.85em;margin-top:5px;">PEI1, PEI2, PEI3, PEI4, DP2</small>
                    </button>
                    <button class="filles" onclick="handleSectionChange('filles')">
                        <span>ğŸ‘©â€ğŸ“</span> Section des Filles
                        <small style="display:block;font-size:0.85em;margin-top:5px;">PEI1, PEI2, PEI3, PEI4, PEI5, DP1, DP2</small>
                    </button>
                </div>
            </section>
            
            <section id="step1" style="display: none;">
                <h2>2. Choisir une Classe</h2>
                <select id="classSelector" onchange="handleClassChange(this.value)">
                    <option value="">-- SÃ©lectionnez une Classe --</option>
                    <option value="PEI1">PEI1</option>
                    <option value="PEI2">PEI2</option>
                    <option value="PEI3">PEI3</option>
                    <option value="PEI4">PEI4</option>
                    <option value="PEI5">PEI5</option>
                    <option value="DP1">DP1</option>
                    <option value="DP2">DP2</option>
                </select>
            </section>
            
            <section id="step3" style="display: none;">
                <h2>3. Choisir un Ã‰lÃ¨ve</h2>
                <select id="studentSelector" onchange="handleStudentChange(this.value)">
                    <option value="">-- SÃ©lectionnez un Ã©lÃ¨ve --</option>
                </select>
            </section>
        </div>

        <div id="studentInfoContainer" class="data-container" style="display: none">
            <h2>Informations Ã‰lÃ¨ve</h2>
            <div class="student-info">
                <div class="student-photo-birthdate-container">
                    <img id="studentPhotoPreview" style="display: none;" src="#" alt="Photo de l'Ã©lÃ¨ve">
                    <div class="birthdate-container">
                        <label for="studentBirthdate">Date de naissance:</label>
                        <input type="date" id="studentBirthdate" onchange="handleStudentBirthdateChange(this.value)" title="Date de naissance">
                    </div>
                </div>
                <div>
                    <label for="studentNameDisplay">Nom:</label>
                    <p id="studentNameDisplay"></p>
                </div>
                <div class="student-info-buttons">
                    <button onclick="showStudentData();" title="Voir toutes les contributions">Afficher Contributions</button>
                </div>
            </div>
            
            <section id="step2" style="display: none; margin-top: 20px; padding: 15px;">
                <h2>4. Choisir une MatiÃ¨re</h2>
                <select id="subjectSelector" onchange="handleSubjectChange(this.value)">
                    <option value="">-- SÃ©lectionnez une matiÃ¨re --</option>
                </select>
            </section>
        </div>

        <div id="contributionEntrySections" style="display: none;">
            <!-- Section FranÃ§aise -->
            <section id="communicationTable" class="french-section">
                <h2>CritÃ¨res Initiaux (CompÃ©tences Approche de l'Apprentissage)</h2>
                <p style="font-size: 0.9em; color: #6c757d;">
                    <span style="font-weight: bold;">E</span>: Excellent | 
                    <span style="font-weight: bold;">A</span>: Acquis | 
                    <span style="font-weight: bold;">PA</span>: Partiellement Acquis | 
                    <span style="font-weight: bold;">I</span>: Insuffisant
                </p>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>Communication</th>
                            <th>Collaboration</th>
                            <th>Autogestion</th>
                            <th>Recherche</th>
                            <th>RÃ©flexion</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Ã‰valuation</th>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>E</option><option>A</option><option>PA</option><option>I</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>E</option><option>A</option><option>PA</option><option>I</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>E</option><option>A</option><option>PA</option><option>I</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>E</option><option>A</option><option>PA</option><option>I</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>E</option><option>A</option><option>PA</option><option>I</option></select></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <!-- Section Arabe -->
            <section id="communicationTableArabic" class="arabic-section" style="display: none; direction: rtl; text-align: right;">
                <h2>Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø£ÙˆÙ„ÙŠØ© (ÙƒÙØ§Ø¡Ø§Øª Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ØªØ¹Ù„Ù…)</h2>
                <p style="font-size: 0.9em; color: #6c757d;">
                    <span style="font-weight: bold;">Ù…</span>: Ù…Ù…ØªØ§Ø² | 
                    <span style="font-weight: bold;">Ù…+</span>: Ù…ÙƒØªØ³Ø¨ | 
                    <span style="font-weight: bold;">Ø¬</span>: Ù…ÙƒØªØ³Ø¨ Ø¬Ø²Ø¦ÙŠØ§Ù‹ | 
                    <span style="font-weight: bold;">Øº</span>: ØºÙŠØ± ÙƒØ§ÙÙ
                </p>
                <table dir="rtl">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Ø§Ù„ØªÙˆØ§ØµÙ„</th>
                            <th>Ø§Ù„ØªØ¹Ø§ÙˆÙ†</th>
                            <th>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</th>
                            <th>Ø§Ù„Ø¨Ø­Ø«</th>
                            <th>Ø§Ù„ØªÙÙƒÙŠØ±</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>Ù…</option><option>Ù…+</option><option>Ø¬</option><option>Øº</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>Ù…</option><option>Ù…+</option><option>Ø¬</option><option>Øº</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>Ù…</option><option>Ù…+</option><option>Ø¬</option><option>Øº</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>Ù…</option><option>Ù…+</option><option>Ø¬</option><option>Øº</option></select></td>
                            <td><select onchange="handleCommunicationChange()"><option value=""></option><option>Ù…</option><option>Ù…+</option><option>Ø¬</option><option>Øº</option></select></td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <!-- Section FranÃ§aise -->
            <section id="criteriaTable" class="french-section">
                <h2>CritÃ¨res d'Ã‰valuation (MatiÃ¨re)</h2>
                <div style="margin-bottom: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                    <label style="margin-right: 15px;">
                        <strong>Nombre d'unitÃ©s - Semestre 1:</strong>
                        <select id="unitsSem1Selector" onchange="handleUnitsChange()" style="margin-left: 5px; padding: 5px;">
                            <option value="1">1 unitÃ© (note directe)</option>
                            <option value="2">2 unitÃ©s</option>
                            <option value="3">3 unitÃ©s</option>
                            <option value="4">4 unitÃ©s</option>
                            <option value="5">5 unitÃ©s</option>
                        </select>
                    </label>
                    <label>
                        <strong>Nombre d'unitÃ©s - Semestre 2:</strong>
                        <select id="unitsSem2Selector" onchange="handleUnitsChange()" style="margin-left: 5px; padding: 5px;">
                            <option value="1">1 unitÃ© (note directe)</option>
                            <option value="2">2 unitÃ©s</option>
                            <option value="3">3 unitÃ©s</option>
                            <option value="4">4 unitÃ©s</option>
                            <option value="5">5 unitÃ©s</option>
                        </select>
                    </label>
                </div>
                <table id="criteriaTableElement">
                    <thead id="criteriaTableHead">
                        <tr>
                            <th>CritÃ¨res</th>
                            <th>Semestre 1 (/8)</th>
                            <th>Semestre 2 (/8)</th>
                            <th>Niveau Final (/8)</th>
                            <th>Seuil Total (/32)</th>
                            <th>Note Finale (/8)</th>
                        </tr>
                    </thead>
                    <tbody id="criteriaTableBody">
                        <tr data-criteria="A">
                            <td>A</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                            <td rowspan="4"><input id="threshold" type="number" readonly tabindex="-1" style="background-color: #e9ecef;"></td>
                            <td rowspan="4"><input id="finalNote" type="number" readonly tabindex="-1" style="background-color: #e9ecef;"></td>
                        </tr>
                        <tr data-criteria="B">
                            <td>B</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                        <tr data-criteria="C">
                            <td>C</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                        <tr data-criteria="D">
                            <td>D</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                    </tbody>
                </table>
                <h3>Commentaires</h3>
                <textarea id="teacherComment" rows="4" placeholder="Ã‰crivez vos commentaires ici..." onchange="handleCommentChange(this.value)"></textarea>
                <h3>Nom de l'enseignant</h3>
                <input id="teacherName" placeholder="Entrez votre nom" onchange="handleTeacherNameChange(this.value)">
                <div style="text-align: right; margin-top: 20px;">
                    <button id="submitButton" onclick="submitForm()">Soumettre / Mettre Ã  jour</button>
                </div>
            </section>
            
            <!-- Section Arabe -->
            <section id="criteriaTableArabic" class="arabic-section" style="display: none; direction: rtl; text-align: right;">
                <h2>Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (Ø§Ù„Ù…Ø§Ø¯Ø©)</h2>
                <div style="margin-bottom: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 5px; direction: rtl;">
                    <label style="margin-left: 15px;">
                        <strong>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„:</strong>
                        <select id="unitsSem1SelectorArabic" onchange="handleUnitsChange()" style="margin-right: 5px; padding: 5px;">
                            <option value="1">ÙˆØ­Ø¯Ø© ÙˆØ§Ø­Ø¯Ø© (Ø¯Ø±Ø¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©)</option>
                            <option value="2">ÙˆØ­Ø¯ØªØ§Ù†</option>
                            <option value="3">3 ÙˆØ­Ø¯Ø§Øª</option>
                            <option value="4">4 ÙˆØ­Ø¯Ø§Øª</option>
                            <option value="5">5 ÙˆØ­Ø¯Ø§Øª</option>
                        </select>
                    </label>
                    <label>
                        <strong>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ:</strong>
                        <select id="unitsSem2SelectorArabic" onchange="handleUnitsChange()" style="margin-right: 5px; padding: 5px;">
                            <option value="1">ÙˆØ­Ø¯Ø© ÙˆØ§Ø­Ø¯Ø© (Ø¯Ø±Ø¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©)</option>
                            <option value="2">ÙˆØ­Ø¯ØªØ§Ù†</option>
                            <option value="3">3 ÙˆØ­Ø¯Ø§Øª</option>
                            <option value="4">4 ÙˆØ­Ø¯Ø§Øª</option>
                            <option value="5">5 ÙˆØ­Ø¯Ø§Øª</option>
                        </select>
                    </label>
                </div>
                <table id="criteriaTableElementArabic" dir="rtl">
                    <thead id="criteriaTableHeadArabic">
                        <tr>
                            <th>Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ±</th>
                            <th>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„ (/8)</th>
                            <th>Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ (/8)</th>
                            <th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (/8)</th>
                            <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ (/32)</th>
                            <th>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (/8)</th>
                        </tr>
                    </thead>
                    <tbody id="criteriaTableBodyArabic">
                        <tr data-criteria="A">
                            <td>Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                            <td rowspan="4"><input id="thresholdArabic" type="number" readonly tabindex="-1" style="background-color: #e9ecef;"></td>
                            <td rowspan="4"><input id="finalNoteArabic" type="number" readonly tabindex="-1" style="background-color: #e9ecef;"></td>
                        </tr>
                        <tr data-criteria="B">
                            <td>Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                        <tr data-criteria="C">
                            <td>Ø§Ù„ØªØ­Ø¯Ø«</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                        <tr data-criteria="D">
                            <td>Ø§Ù„ÙƒØªØ§Ø¨Ø©</td>
                            <td class="sem1-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td class="sem2-cell"><input type="number" min="0" max="8" oninput="validateInput(this)"></td>
                            <td><input type="number" readonly tabindex="-1" class="final-level-input"></td>
                        </tr>
                    </tbody>
                </table>
                <h3>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
                <textarea id="teacherCommentArabic" rows="4" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ø§ØªÙƒ Ù‡Ù†Ø§..." onchange="handleCommentChange(this.value)"></textarea>
                <h3>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</h3>
                <input id="teacherNameArabic" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ" onchange="handleTeacherNameChange(this.value)">
                <div style="text-align: left; margin-top: 20px;">
                    <button id="submitButtonArabic" onclick="submitForm()">Ø¥Ø±Ø³Ø§Ù„ / ØªØ­Ø¯ÙŠØ«</button>
                </div>
            </section>
        </div>

        <div class="data-container" id="dataContainer"></div>
    </main>

    <script src="/script.js"></script>
    <script>
        // script.js charge toutes les fonctions et variables requises.
        // Ici, nous n'ajoutons que les handlers nÃ©cessaires pour les attributs HTML inline.
        window.handleSectionChange = handleSectionChange;
        window.handleClassChange = handleClassChange;
        window.handleStudentChange = handleStudentChange;
        window.handleSubjectChange = handleSubjectChange;
        window.handleCommunicationChange = handleCommunicationChange;
        window.handleTeacherNameChange = handleTeacherNameChange;
        window.handleStudentBirthdateChange = handleStudentBirthdateChange;
        window.handleUnitsChange = handleUnitsChange;
        window.validateInput = validateInput;
        window.submitForm = submitForm;
        window.showStudentData = showStudentData;
        window.toggleContributionDetails = toggleContributionDetails;
        window.editContribution = editContribution;
        window.deleteContribution = deleteContribution;
        window.generateAllWordsInSection = generateAllWordsInSection;
        window.generateExcel = generateExcel;

        document.addEventListener('DOMContentLoaded', () => {
            console.log('Application prÃªte.');
        });
    </script>
</body>
</html>
